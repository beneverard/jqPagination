/*!
 * jqPagination, a jQuery pagination plugin (obviously)
 *
 * Copyright (C) 2011 Ben Everard
 *
 * http://beneverard.github.com/jqPagination
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *     
 */(function(a){"use strict";a.jqPagination=function(b,c){var d=this;d.$el=a(b);d.el=b;d.$input=d.$el.find("input");d.$el.data("jqPagination",d);d.init=function(){d.options=a.extend({},a.jqPagination.defaultOptions,c);d.options.max_page===null&&(d.$input.data("max-page")!==undefined?d.options.max_page=d.$input.data("max-page"):d.options.max_page=1);d.$input.data("current-page")!==undefined&&d.isNumber(d.$input.data("current-page"))&&(d.options.current_page=d.$input.data("current-page"));d.$input.removeAttr("readonly");d.updateInput(!0);d.$input.on("focus.jqPagination mouseup.jqPagination",function(b){if(b.type==="focus"){var c=a(this);c.val(c.data("current-page")).select()}if(b.type==="mouseup")return!1});d.$input.on("blur.jqPagination keydown.jqPagination",function(b){var c=a(this),e=parseInt(d.options.current_page,10);if(b.keyCode===27){c.val(e);c.blur()}b.keyCode===13&&c.blur();b.type==="blur"&&d.setPage(c.val())});d.$el.on("click.jqPagination","a",function(b){var c=a(this);if(c.hasClass("disabled"))return!1;if(!b.metaKey&&!b.ctrlKey){b.preventDefault();d.setPage(c.data("action"))}})};d.setPage=function(a){if(a===undefined)return d.options.current_page;var b=parseInt(d.options.current_page,10),c=parseInt(d.options.max_page,10);if(isNaN(parseInt(a,10)))switch(a){case"first":a=1;break;case"prev":case"previous":a=b-1;break;case"next":a=b+1;break;case"last":a=c}a=parseInt(a,10);if(isNaN(a)||a<1||a>c||a===b){d.setInputValue(b);return!1}d.options.current_page=a;d.$input.data("current-page",a);d.updateInput()};d.setMaxPage=function(a){if(a===undefined)return d.options.max_page;if(!d.isNumber(a)){console.error("jqPagination: max_page is not a number");return!1}if(a<d.options.current_page){console.error("jqPagination: max_page lower than current_page");return!1}d.options.max_page=a;d.$input.data("max-page",a);d.updateInput()};d.updateInput=function(a){var b=parseInt(d.options.current_page,10);d.setInputValue(b);d.setLinks(b);a!==!0&&d.options.paged(b)};d.setInputValue=function(a){var b=d.options.page_string,c=d.options.max_page;b=b.replace("{current_page}",a).replace("{max_page}",c);d.$input.val(b)};d.isNumber=function(a){return!isNaN(parseFloat(a))&&isFinite(a)};d.setLinks=function(a){var b=d.options.link_string,c=parseInt(d.options.current_page,10),e=parseInt(d.options.max_page,10);if(b!==""){var f=c-1;f<1&&(f=1);var g=c+1;g>e&&(g=e);d.$el.find("a.first").attr("href",b.replace("{page_number}","1"));d.$el.find("a.prev, a.previous").attr("href",b.replace("{page_number}",f));d.$el.find("a.next").attr("href",b.replace("{page_number}",g));d.$el.find("a.last").attr("href",b.replace("{page_number}",e))}d.$el.find("a").removeClass("disabled");c===e&&d.$el.find(".next, .last").addClass("disabled");c===1&&d.$el.find(".previous, .first").addClass("disabled")};d.callMethod=function(a,b,c){switch(a.toLowerCase()){case"option":switch(a.toLowerCase()){case"current_page":return d.setPage(c);case"max_page":return d.setMaxPage(c)}console.error("jqPagination: cannot get / set option "+b);return!1;case"destroy":d.$el.off(".jqPagination").find("*").off(".jqPagination");break;default:console.error('jqPagination: method "'+a+'" does not exist');return!1}};d.init()};a.jqPagination.defaultOptions={current_page:1,link_string:"",max_page:null,page_string:"Page {current_page} of {max_page}",paged:function(){}};a.fn.jqPagination=function(){var b=this,c=Array.prototype.slice.call(arguments);if(typeof c[0]=="string"){b.length>1&&(b=b.eq(0));var d=a(b).data("jqPagination");return d.callMethod(c[0],c[1],c[2])}b.each(function(){new a.jqPagination(this,c[0])})}})(jQuery);if(!console){var console={},func=function(){return!1};console.log=func;console.info=func;console.warn=func;console.error=func};